services:
  ollama:
    image: ollama/ollama:rocm
    container_name: ollama
    ports:
      - "11431:11434"
    volumes:
      - ./ollama:/root/.ollama
    entrypoint: >
      /bin/sh -c "
          ollama serve &
          sleep 2 && 
          ollama pull gemma3:4b-it-q4_K_M &&
          ollama pull mxbai-embed-large &&
          wait
      "
    devices:
      - /dev/kfd
      - /dev/dri
    restart: unless-stopped
